import scrapy
from scrapy_splash import SplashRequest
main_list=[]
keywords=[
    'Afrikaans',
    'Amharic',
    'Arabic',
    'Armenian',
    'Azerbaijani',
    'Basque',
    'Belarusian',
    'Bengali',
    'Bulgarian',
    'Burmese',
    'Catalan',
    'Chinese',
    'Croatian',
    'Czech',
    'Danish',
    'Dutch',
    'English',
    'Estonian',
    'Filipino',
    'Finnish',
    'French',
    'Galician',
    'Georgian',
    'German',
    'Greek',
    'Hebrew',
    'Hindi',
    'Hungarian',
    'Icelandic',
    'Indonesian',
    'Italian',
    'Japanese',
    'Kannada',
    'Khmer',
    'Korean',
    'Kyrgyz',
    'Lao',
    'Latvian',
    'Lithuanian',
    'Macedonian',
    'Malay',
    'Malayalam',
    'Marathi',
    'Mongolian',
    'Nepali',
    'Norwegian',
    'Persian',
    'Polish',
    'Portuguese',
    'Portuguese',
    'Romanian',
    'Romansh',
    'Russian',
    'Serbian',
    'Sinhala',
    'Slovak',
    'Slovenian',
    'Spanish',
    'Swahili',
    'Swedish',
    'Tamil',
    'Telugu',
    'Thai',
    'Turkish',
    'Ukrainian',
    'Vietnamese',
    'Zulu',
    '4X',
    'Abstract+strategy',
    'Action',
    'Action+role+playing',
    'Action+adventure',
    'Adventure',
    'American+football',
    'Arcade',
    'Basketball',
    'Beat+em+up',
    'Billiards',
    'Bingo',
    'Blackjack',
    'Board',
    'Bowling',
    'Boxing',
    'Brain+training',
    'Brick+break',
    'Bubble+shooter',
    'Business+tycoon',
    'Car+racing',
    'Car+simulator',
    'Card',
    'Care+simulation',
    'Casino',
    'Casual',
    'Checkers',
    'Chess',
    'City+building',
    'Collectible+cards',
    'Construction+management+simulation',
    'Cricket',
    'Crossword',
    'Dating+simulation',
    'Dentist',
    'Dice',
    'Doctor',
    'Drawing',
    'Dress+up',
    'Drums',
    'Educational',
    'Endless+runner',
    'Escape+the+room',
    'Farming',
    'Fighting',
    'Flight+simulator',
    'Go',
    'Golf',
    'Government+political',
    'Hero+shooter',
    'Hidden+object',
    'Hockey',
    'Incremental',
    'Interactive+fiction',
    'Japanese+role+playing',
    'Jigsaw+puzzle',
    'Kart+racing',
    'Life+simulation',
    'Logo+quiz',
    'Ludo',
    'Mahjong',
    'Mahjong+solitaire',
    'Massively+multiplayer+online+role+playing',
    'Match+3',
    'Memory',
    'Merge+puzzle',
    'Motorcycle+racing',
    'Multiplayer+online+battle+arena',
    'Music',
    'Pet',
    'Physics+based',
    'Piano',
    'Platform+action+adventure',
    'Platformer',
    'Poker',
    'Puzzle',
    'Puzzle+role+playing',
    'Puzzle+adventure',
    'Racing',
    'Racing+simulator',
    'Restaurant+cooking',
    'Rhythm',
    'Roguelike',
    'Role+playing',
    'Rummy',
    'Shoot+em+up',
    'Shooter',
    'Shooting+range',
    'Simulation',
    'Sliding+puzzle',
    'Slot+machine',
    'Soccer',
    'Social+simulation',
    'Solitaire',
    'Sports',
    'Sports+management',
    'Sports+based+fighting',
    'Strategy',
    'Stunt+driving',
    'Survival',
    'Survival+horror',
    'Table+game',
    'Tactical+role+playing',
    'Teen+patti',
    'Tile+matching',
    'Tower+defense',
    'Train+simulator',
    'Trivia',
    'Truck+racing',
    'Truck+simulator',
    'Vehicle+simulation',
    'Visual+novel',
    'Wargame',
    'Winter+sports',
    'Word',
    'Word+search',
    'Wrestling',
    'Activity+tracker',
    'Air+Travel',
    'Art+design',
    'Audio+recorder',
    'Audiobook',
    'Auto+vehicles',
    'Baby+care',
    'Barcode+scanner',
    'Baseball',
    'Beauty',
    'Boating',
    'Books+reference',
    'Bus',
    'Business',
    'Communication',
    'Early+childhood+education',
    'Education',
    'Email',
    'Emoji',
    'Encyclopedia',
    'Entertainment',
    'Events',
    'Fashion',
    'Finance',
    'Flashlight',
    'Food+drink',
    'Food+delivery',
    'Health+Fitness',
    'Lifestyle',
    'Music+audio',
    'Network+connectivity',
    'Parenting',
    'Personalisation',
    'Professional+network+service',
    'Pronunciation',
    'Public+transport',
    'Racing',
    'Racquet+sports',
    'Radio',
    'Recipe',
    'Religious+text',
    'Remote+control',
    'Restaurant',
    'Resume',
    'Ringtone',
    'Rugby',
    'Running',
    'Science+education',
    'Self+help',
    'Shopping',
    'Skiing',
    'Sleep',
    'Social',
    'Sound+effect',
    'Speedometer',
    'Sports',
    'Sports+coaching',
    'Study+guide',
    'Taxi+rideshare',
    'Tennis',
    'Test+preparation',
    'Text+messaging',
    'Theme',
    'Tools',
    'Train',
    'Travel+local',
    'Travel+guide',
    'TV',
    'TV+guide',
    'Vehicle+maintenance',
    'Vehicle+shopping',
    'Video+call',
    'Video+download',
    'Video+editing',
    'Video+player',
    'Video+streaming',
    'Virtual+reality',
    'Wallpaper',
    'Weather',
    'Web+browser',
    'Weight+loss',
    'Wi+fi',
    'Wireless+service+provider',
    'News',
    'Tips+and+Tricks',
    'Marketing',
    'snapchat',
    'instagram',
    'facebook',
    'youtube',
    'kik',
    'twitter',
    'tinder',
    'messenger',
    'pandora',
    'netflix',
    'spotify',
    'google',
    'uber',
    'whatsapp',
    'amazon',
    'mario',
    'bitmoji',
    'lyft',
    '8+ball+pool',
    'pokemon+go',
    'pinterest',
    'tumblr',
    'vpn',
    'super+mario',
    'free+games',
    'grindr',
    'minecraft',
    'skype',
    'facebook+app+for+iphone',
    'fam',
    'gmail',
    'clash+royale',
    'google+maps',
    'roblox',
    'soundcloud',
    'chrome',
    'facebook+messenger',
    'flipagram',
    'house+party',
    'clash+of+clans',
    'candy+crush',
    'photo+editor',
    'shazam',
    'uber+app',
    'waze',
    'pof',
    'bumble',
    'ebay',
    'google+docs',
    'meet+me',
    'viber',
    'trivia+crack',
    'wish',
    'pic+collage',
    'venmo',
    'google+drive',
    'episode',
    'text+free',
    'snap+chat',
    'angry+birds',
    'groupon',
    'imo',
    'imovie',
    'hulu',
    'music',
    'telegram',
    'starbucks',
    'kik+messenger',
    'amazon+prime',
    'calculator',
    'color+switch',
    'dropbox',
    'elf+yourself',
    'heads+up',
    'hooked',
    'paypal',
    'oovoo',
    'pokemon',
    'tango',
    'subway+surfers',
    'text+now',
    'instasize',
    'words+with+friends',
    'yahoo+mail',
    'group+me',
    'games+for+free',
    'hotspot+shield',
    'likes+for+instagram',
    'quizlet',
    'solitaire',
    'vine',
    'the+weather+channel',
    'walmart',
    'video+editor',
    'picsart',
    'qq',
    'chase',
    'after+school',
    'song+download',
    'launcher',
    'vpn+for+pubg',
    'matrimony',
    'Afghanistan',
    'Albania',
    'Algeria',
    'Andorra',
    'Angola',
    'Antigua+and+Barbuda',
    'Argentina',
    'Armenia',
    'Australia',
    'Austria',
    'Azerbaijan',
    'Bahamas',
    'Bahrain',
    'Bangladesh',
    'Barbados',
    'Belarus',
    'Belgium',
    'Belize',
    'Benin',
    'Bhutan',
    'Bolivia',
    'Bosnia+and+Herzegovina',
    'Botswana',
    'Brazil',
    'Brunei',
    'Bulgaria',
    'Burkina+Faso',
    'Burundi',
    'Cabo+Verde',
    'Cambodia',
    'Cameroon',
    'Canada',
    'Central+African+Republic',
    'Chad',
    'Chile',
    'China',
    'Colombia',
    'Comoros',
    'Congo',
    'Costa+Rica',
    'Croatia',
    'Cuba',
    'Cyprus',
    'Czechia',
    'Democratic+Republic+of+the+Congo',
    'Denmark',
    'Djibouti',
    'Dominica',
    'Dominican+Republic',
    'Ecuador',
    'Egypt',
    'El+Salvador',
    'Equatorial+Guinea',
    'Eritrea',
    'Estonia',
    'Eswatini',
    'Ethiopia',
    'Fiji',
    'Finland',
    'France',
    'Gabon',
    'Gambia',
    'Georgia',
    'Germany',
    'Ghana',
    'Greece',
    'Grenada',
    'Guatemala',
    'Guinea',
    'Guinea+Bissau',
    'Guyana',
    'Haiti',
    'Holy+See',
    'Honduras',
    'Hungary',
    'Iceland',
    'India',
    'Indonesia',
    'Iran',
    'Iraq',
    'Ireland',
    'Israel',
    'Italy',
    'Jamaica',
    'Japanese',
    'Jordan',
    'Kazakhstan',
    'Kenya',
    'Kiribati',
    'Kuwait',
    'Kyrgyzstan',
    'Laos',
    'Latvia',
    'Lebanon',
    'Lesotho',
    'Liberia',
    'Libya',
    'Liechtenstein',
    'Lithuania',
    'Luxembourg',
    'Madagascar',
    'Malawi',
    'Malaysia',
    'Maldives',
    'Mali',
    'Malta',
    'Marshall+Islands',
    'Mauritania',
    'Mauritius',
    'Mexico',
    'Micronesia',
    'Moldova',
    'Monaco',
    'Mongolia',
    'Montenegro',
    'Morocco',
    'Mozambique',
    'Myanmar',
    'Namibia',
    'Nauru',
    'Nepal',
    'Netherlands',
    'New+Zealand',
    'Nicaragua',
    'Niger',
    'Nigeria',
    'North+Korea',
    'North+Macedonia',
    'Norway',
    'Oman',
    'Pakistan',
    'Palau',
    'Palestine+State',
    'Panama',
    'Papua+New+Guinea',
    'Paraguay',
    'Per',
    'Philippines',
    'Poland',
    'Portugal',
    'Qatar',
    'Romania',
    'Russia',
    'Rwanda',
    'Saint+Kitts+and+Nevis',
    'Saint+Lucia',
    'Saint+Vincent+and+the+Grenadines',
    'Samoa',
    'San+Marino',
    'Sao+Tome+and+Principe',
    'Saudi+Arabia',
    'Senegal',
    'Serbia',
    'Seychelles',
    'Sierra+Leone',
    'Singapore',
    'Slovakia',
    'Slovenia',
    'Solomon+Islands',
    'Somalia',
    'South+Africa',
    'South+Korea',
    'South+Sudan',
    'Spain',
    'Sri+Lanka',
    'Sudan',
    'Suriname',
    'Sweden',
    'Switzerland',
    'Syria',
    'Tajikistan',
    'Tanzania',
    'Thailand',
    'Timor+Leste',
    'Togo',
    'Tonga',
    'Trinidad+and+Tobago',
    'Tunisia',
    'Turkey',
    'Turkmenistan',
    'Tuvalu',
    'Uganda',
    'Ukraine',
    'United+Arab+Emirates',
    'United+Kingdom',
    'United+States+of+America',
    'Uruguay',
    'Uzbekistan',
    'Vanuatu',
    'Venezuela',
    'Vietnam',
    'Yemen',
    'Zambia	',
    'Zimbabwe'
]
class DynamicSpider(scrapy.Spider):
    name = 'dynamic'
    allowed_domains = ['x']
    def start_requests(self):
        script = """
                    function main(splash,args)
                        splash:set_viewport_size(1028, 10000)
                        splash:go(args.url)
                        local scroll_to = splash:jsfunc("window.scrollTo")
                        scroll_to(0, 2900)
                        splash:wait(8)
                        return {
                            html = splash:html()
                        }
                    end
                  """
        for i in keywords:       
            url='https://play.google.com/store/search?q='+i+'&c=apps'
            yield SplashRequest(url, self.parse,  endpoint='execute', args={'lua_source': script, 'url': url})

    def parse(self, response):
        dev_link=[]
        app_developer_link=response.css('.b8cIId.ReQCgd.KoLSrc a.mnKHRc::attr(href)').extract()
        for link in app_developer_link:
            dev_link.append(link.split('=')[-1])
            for x in dev_link:
                main_list.append(x)
        print(len(main_list))
        temp_list = []
        for i in main_list:
            if i not in temp_list:
                temp_list.append(i)
        mylist = temp_list
        #print(temp_list)
        print("List After removing duplicates ", len(mylist))    
        
        #print(main_list)
        yield {'id':mylist}

    
